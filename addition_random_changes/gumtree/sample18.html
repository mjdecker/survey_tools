<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tool4</title><link type="text/css" href="res/web/bootstrap.min.css" rel="stylesheet"/><link type="text/css" href="res/web/gumtree.css" rel="stylesheet"/></head><body><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="btn-toolbar pull-right"><div class="btn-group"><a class="btn btn-default btn-xs" id="legend" href="#" data-toggle="popover" data-html="true" data-placement="bottom" data-content="<span class=&quot;del&quot;>&nbsp;&nbsp;</span> deleted<br><span class=&quot;add&quot;>&nbsp;&nbsp;</span> added<br><span class=&quot;mv&quot;>&nbsp;&nbsp;</span> moved<br><span class=&quot;upd&quot;>&nbsp;&nbsp;</span> updated<br>" data-original-title="Legend" title="Legend" role="button">Legend</a><a class="btn btn-default btn-xs" id="shortcuts" href="#" data-toggle="popover" data-html="true" data-placement="bottom" data-content="<b>n</b> next<br><b>t</b> top<br><b>b</b> bottom" data-original-title="Shortcuts" title="Shortcuts" role="button">Shortcuts</a></div><div class="btn-group"></div></div></div></div><div class="row"><div class="col-lg-6 max-height"><h5>original.java</h5><pre class="pre max-height">@Test
public void testAllMappersNoBoost() throws Exception {
    String mapping = copyToStringFromClasspath("/org/elasticsearch/index/mapper/all/noboost-mapping.json");
    DocumentMapper docMapper = <span class="marker" id="mapping-1"></span><span class="token mv" id="move-src-1" data-title="MethodInvocation/SimpleName"><span class="marker" id="mapping-2"></span><span class="token upd" id="move-src-2" data-title="MethodInvocation/SimpleName">M<span class="cupd">apper</span>T<span class="cupd">e</span>stUtils</span></span>.<span class="marker" id="mapping-3"></span><span class="token upd" id="move-src-3" data-title="MethodInvocation/SimpleName"><span class="cupd">n</span><span class="cupd">e</span>w<span class="cupd">Parser</span></span>().parse(mapping);
    byte[] json = copyToBytesFromClasspath("/org/elasticsearch/index/mapper/all/test1.json");
    Document doc = docMapper.parse(new BytesArray(json)).rootDoc();
    AllField field = (AllField) doc.getField("_all");
    AllEntries allEntries = field.getAllEntries();
    assertThat(allEntries.fields().size(), equalTo(3));
    assertThat(allEntries.fields().contains("address.last.location"), equalTo(true));
    assertThat(allEntries.fields().contains("name.last"), equalTo(true));
    assertThat(allEntries.fields().contains("simple1"), equalTo(true));
    FieldMapper mapper = docMapper.mappers().smartNameFieldMapper("_all");
    assertThat(field.fieldType().omitNorms(), equalTo(false));
    assertThat(mapper.queryStringTermQuery(new Term("_all", "foobar")), Matchers.instanceOf(TermQuery.class));
}}
</pre></div><div class="col-lg-6 max-height"><h5>modified.java</h5><pre class="pre max-height">@Test
public void testAllMappersNoBoost() throws Exception {
    String mapping = copyToStringFromClasspath("/org/elasticsearch/index/mapper/all/noboost-mapping.json");
    DocumentMapper docMapper = <span class="marker" id="mapping-4"></span><span class="token add" data-title="MethodInvocation/MethodInvocation">createIndex("test").<span class="marker" id="mapping-5"></span><span class="token mv" id="move-dst-2" data-title="MethodInvocation/SimpleName"><span class="marker" id="mapping-6"></span><span class="token upd" id="move-dst-2" data-title="MethodInvocation/SimpleName">m<span class="cupd">apper</span>S<span class="cupd">e</span>rvice</span></span>()</span>.<span class="marker" id="mapping-7"></span><span class="token upd" id="move-dst-3" data-title="MethodInvocation/SimpleName">docume<span class="cupd">n</span>tMapp<span class="cupd">e</span>r<span class="cupd">Parser</span></span>().parse(mapping);
    byte[] json = copyToBytesFromClasspath("/org/elasticsearch/index/mapper/all/test1.json");
    Document doc = docMapper.parse(new BytesArray(json)).rootDoc();
    AllField field = (AllField) doc.getField("_all");
    AllEntries allEntries = field.getAllEntries();
    assertThat(allEntries.fields().size(), equalTo(3));
    assertThat(allEntries.fields().contains("address.last.location"), equalTo(true));
    assertThat(allEntries.fields().contains("name.last"), equalTo(true));
    assertThat(allEntries.fields().contains("simple1"), equalTo(true));
    FieldMapper mapper = docMapper.mappers().smartNameFieldMapper("_all");
    assertThat(field.fieldType().omitNorms(), equalTo(false));
    assertThat(mapper.queryStringTermQuery(new Term("_all", "foobar")), Matchers.instanceOf(TermQuery.class));
}}
</pre></div></div></div><script type="text/javascript" src="res/web/jquery.min.js"></script><script type="text/javascript" src="res/web/bootstrap.min.js"></script><script type="text/javascript" src="res/web/diff.js"></script></body></html>