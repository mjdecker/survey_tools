<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Tool3</title></head><body><div style="font-family: courier, monospace;"><table style="border-collapse: collapse;"><tr><td style="border: 1px solid black;"><table><tr><th><strong>Original</strong></th></tr><tr><td><pre><span><span style="color: grey"> 1 </span></span><span><span style="background-color: transparent">@Test</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 2 </span></span><span><span style="background-color: transparent">public void passQueryAsJSONStringTest() throws Exception {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 3 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">client().admin().indices().</span></span><span><span style="background-color: transparent">prepareCreate("test").setSettings(</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 4 </span></span><span><span style="background-color: transparent">        </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">ImmutableSettings.settingsBuilder().put("index.number_of_shards",</span></span><span><span style="background-color: transparent"> 1</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">)</span></span><span><span style="background-color: transparent">)</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">.execute().actionGet()</span></span><span><span style="background-color: transparent">;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 5 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 6 </span></span><span><span style="background-color: transparent">    client().prepareIndex("test", "type1", "1")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 7 </span></span><span><span style="background-color: transparent">        .setSource("field1", "value1_1", "field2", "value2_1")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 8 </span></span><span><span style="background-color: transparent">        .setRefresh(true).</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">execute().actionGet()</span></span><span><span style="background-color: transparent">;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 9 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">10 </span></span><span><span style="background-color: transparent">    WrapperQueryBuilder wrapper</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">11 </span></span><span><span style="background-color: transparent">         = new WrapperQueryBuilder("{ \"term\" : { \"field1\" : \"value1_1\" } }");</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">12 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">CountResponse countResponse =</span></span><span><span style="background-color: transparent"> client().prepareCount()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">13 </span></span><span><span style="background-color: transparent">        .setQuery(wrapper).</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">execute().actionGet()</span></span><span><span style="background-color: transparent">;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">14 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">assertHitCount(countResponse, 1l);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">15 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">16 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">BoolQueryBuilder bool = new BoolQueryBuilder();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">17 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">bool.must(wrapper);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">18 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">bool.</span></span><span><span style="background-color: transparent">must(new TermQueryBuilder(</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">19 </span></span><span><span style="background-color: transparent">        "field2", "value2_1"));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">20 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">21 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">countResponse =</span></span><span><span style="background-color: transparent"> client().prepareCount().setQuery(</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">wrapper</span></span><span><span style="background-color: transparent">).</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">execute().actionGet()</span></span><span><span style="background-color: transparent">;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">22 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">assertHitCount(countResponse, 1l);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">23 </span></span><span><span style="background-color: transparent">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">24 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span></pre></td></tr></table></td><td style="border: 1px solid black; border-collapse: collapse;"><table><tr><th><strong>Modified</strong></th></tr><tr><td><pre><span><span style="color: grey"> 1 </span></span><span><span style="background-color: transparent">@Test</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 2 </span></span><span><span style="background-color: transparent">public void passQueryAsJSONStringTest() throws Exception {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 3 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">assertAcked(</span></span><span><span style="background-color: transparent">prepareCreate("test").setSettings(</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">SETTING_NUMBER_OF_SHARDS,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 4 </span></span><span><span style="background-color: transparent">          1)</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">)</span></span><span><span style="background-color: transparent">;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 5 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 6 </span></span><span><span style="background-color: transparent">    client().prepareIndex("test", "type1", "1")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 7 </span></span><span><span style="background-color: transparent">        .setSource("field1", "value1_1", "field2", "value2_1")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 8 </span></span><span><span style="background-color: transparent">        .setRefresh(true).</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">get()</span></span><span><span style="background-color: transparent">;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 9 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">10 </span></span><span><span style="background-color: transparent">    WrapperQueryBuilder wrapper</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">11 </span></span><span><span style="background-color: transparent">         = new WrapperQueryBuilder("{ \"term\" : { \"field1\" : \"value1_1\" } }");</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">12 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">assertHitCount(</span></span><span><span style="background-color: transparent">client().prepareCount()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">13 </span></span><span><span style="background-color: transparent">        .setQuery(wrapper).</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">get(), 1l)</span></span><span><span style="background-color: transparent">;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">   </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">   </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">   </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">14 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">15 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">BoolQueryBuilder bool =</span></span><span><span style="background-color: transparent"> </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">boolQuery().must(wrapper).</span></span><span><span style="background-color: transparent">must(new TermQueryBuilder(</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">16 </span></span><span><span style="background-color: transparent">        "field2", "value2_1"));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">   </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">17 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">assertHitCount(</span></span><span><span style="background-color: transparent"> client().prepareCount().setQuery(</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">bool</span></span><span><span style="background-color: transparent">).</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">get(), 1l)</span></span><span><span style="background-color: transparent">;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">   </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">18 </span></span><span><span style="background-color: transparent">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">19 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span></pre></td></tr></table></td></tr></table></div></body></html>