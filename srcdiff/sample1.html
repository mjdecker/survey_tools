<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Tool3</title></head><body><div style="font-family: courier, monospace;"><table style="border-collapse: collapse;"><tr><td style="border: 1px solid black;"><table><tr><th><strong>Original</strong></th></tr><tr><td><pre><span><span style="color: grey"> 1 </span></span><span><span style="background-color: transparent">@Test</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 2 </span></span><span><span style="background-color: transparent">public void testGeoHashValue() throws Exception {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 3 </span></span><span><span style="background-color: transparent">    String mapping = XContentFactory.jsonBuilder()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 4 </span></span><span><span style="background-color: transparent">            .startObject().startObject("type")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 5 </span></span><span><span style="background-color: transparent">            .startObject("properties").startObject("point")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 6 </span></span><span><span style="background-color: transparent">            .field("type", "geo_point").field("lat_lon", true)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 7 </span></span><span><span style="background-color: transparent">            .field("geohash", true).endObject().endObject()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 8 </span></span><span><span style="background-color: transparent">            .endObject().endObject().string();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 9 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">10 </span></span><span><span style="background-color: transparent">    DocumentMapper defaultMapper</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">11 </span></span><span><span style="background-color: transparent">    = </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">MapperTestUtils.newParser()</span></span><span><span style="background-color: transparent">.parse(mapping);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">12 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">13 </span></span><span><span style="background-color: transparent">    ParsedDocument doc = defaultMapper.parse("type", "1", XContentFactory</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">14 </span></span><span><span style="background-color: transparent">            .jsonBuilder()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">15 </span></span><span><span style="background-color: transparent">            .startObject()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">16 </span></span><span><span style="background-color: transparent">            .field("point", GeoHashUtils.encode(1.2, 1.3))</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">17 </span></span><span><span style="background-color: transparent">            .endObject()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">18 </span></span><span><span style="background-color: transparent">            .bytes());</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">19 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">20 </span></span><span><span style="background-color: transparent">    assertThat(doc.rootDoc().getField("point.lat"), notNullValue());</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">21 </span></span><span><span style="background-color: transparent">    assertThat(doc.rootDoc().getField("point.lon"), notNullValue());</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">22 </span></span><span><span style="background-color: transparent">    assertThat(doc.rootDoc().get("point.geohash"),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">23 </span></span><span><span style="background-color: transparent">        equalTo(GeoHashUtils.encode(1.2, 1.3)));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">24 </span></span><span><span style="background-color: transparent">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">25 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span></pre></td></tr></table></td><td style="border: 1px solid black; border-collapse: collapse;"><table><tr><th><strong>Modified</strong></th></tr><tr><td><pre><span><span style="color: grey"> 1 </span></span><span><span style="background-color: transparent">@Test</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 2 </span></span><span><span style="background-color: transparent">public void testGeoHashValue() throws Exception {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 3 </span></span><span><span style="background-color: transparent">    String mapping = XContentFactory.jsonBuilder()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 4 </span></span><span><span style="background-color: transparent">            .startObject().startObject("type")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 5 </span></span><span><span style="background-color: transparent">            .startObject("properties").startObject("point")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 6 </span></span><span><span style="background-color: transparent">            .field("type", "geo_point").field("lat_lon", true)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 7 </span></span><span><span style="background-color: transparent">            .field("geohash", true).endObject().endObject()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 8 </span></span><span><span style="background-color: transparent">            .endObject().endObject().string();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 9 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">10 </span></span><span><span style="background-color: transparent">    DocumentMapper defaultMapper</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">11 </span></span><span><span style="background-color: transparent">    = </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">createIndex("test")</span></span><span><span style="background-color: transparent">.</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">mapperService().documentMapperParser().</span></span><span><span style="background-color: transparent">parse(mapping);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">12 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">13 </span></span><span><span style="background-color: transparent">    ParsedDocument doc = defaultMapper.parse("type", "1", XContentFactory</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">14 </span></span><span><span style="background-color: transparent">            .jsonBuilder()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">15 </span></span><span><span style="background-color: transparent">            .startObject()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">16 </span></span><span><span style="background-color: transparent">            .field("point", GeoHashUtils.encode(1.2, 1.3))</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">17 </span></span><span><span style="background-color: transparent">            .endObject()</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">18 </span></span><span><span style="background-color: transparent">            .bytes());</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">19 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">20 </span></span><span><span style="background-color: transparent">    assertThat(doc.rootDoc().getField("point.lat"), notNullValue());</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">21 </span></span><span><span style="background-color: transparent">    assertThat(doc.rootDoc().getField("point.lon"), notNullValue());</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">22 </span></span><span><span style="background-color: transparent">    assertThat(doc.rootDoc().get("point.geohash"),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">23 </span></span><span><span style="background-color: transparent">        equalTo(GeoHashUtils.encode(1.2, 1.3)));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">24 </span></span><span><span style="background-color: transparent">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">25 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span></pre></td></tr></table></td></tr></table></div></body></html>