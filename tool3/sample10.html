<html><head></head><body><div style="font-family: courier, monospace;"><table style="border-collapse: collapse;"><tr><td style="border: 1px solid black;"><table><tr><th><strong>Original</strong></th></tr><tr><td><pre><span><span style="color: grey">  1 </span></span><span><span style="background-color: transparent">package com.google.common.cache;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  2 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  3 </span></span><span><span style="background-color: transparent">import com.google.common.base.Function;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  4 </span></span><span><span style="background-color: transparent">import com.google.common.base.Objects;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  5 </span></span><span><span style="background-color: transparent">import com.google.common.base.Optional;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  6 </span></span><span><span style="background-color: transparent">import com.google.common.base.Preconditions;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  7 </span></span><span><span style="background-color: transparent">import com.google.common.cache.LocalCache.Strength;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  8 </span></span><span><span style="background-color: transparent">import com.google.common.collect.Iterables;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  9 </span></span><span><span style="background-color: transparent">import com.google.common.collect.Lists;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 10 </span></span><span><span style="background-color: transparent">import com.google.common.collect.Sets;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 11 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 12 </span></span><span><span style="background-color: transparent">import java.util.List;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 13 </span></span><span><span style="background-color: transparent">import java.util.Set;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 14 </span></span><span><span style="background-color: transparent">import java.util.concurrent.TimeUnit;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 15 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 16 </span></span><span><span style="background-color: transparent">import javax.annotation.Nullable;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 17 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 18 </span></span><span><span style="background-color: transparent">class CacheBuilderFactory {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 19 </span></span><span><span style="background-color: transparent">  private Set&lt;Integer&gt; concurrencyLevels = Sets.newHashSet((Integer) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 20 </span></span><span><span style="background-color: transparent">  private Set&lt;Integer&gt; initialCapacities = Sets.newHashSet((Integer) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 21 </span></span><span><span style="background-color: transparent">  private Set&lt;Integer&gt; maximumSizes = Sets.newHashSet((Integer) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 22 </span></span><span><span style="background-color: transparent">  private Set&lt;</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">ExpirationSpec</span></span><span><span style="background-color: transparent">&gt; </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expirations</span></span><span><span style="background-color: transparent"> = Sets.newHashSet((</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">ExpirationSpec</span></span><span><span style="background-color: transparent">) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 23 </span></span><span><span style="background-color: transparent">  private Set&lt;Strength&gt; keyStrengths = Sets.newHashSet((Strength) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 24 </span></span><span><span style="background-color: transparent">  private Set&lt;Strength&gt; valueStrengths = Sets.newHashSet((Strength) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 25 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 26 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withConcurrencyLevels(Set&lt;Integer&gt; concurrencyLevels) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 27 </span></span><span><span style="background-color: transparent">    this.concurrencyLevels = Sets.newLinkedHashSet(concurrencyLevels);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 28 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 29 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 30 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 31 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withInitialCapacities(Set&lt;Integer&gt; initialCapacities) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 32 </span></span><span><span style="background-color: transparent">    this.initialCapacities = Sets.newLinkedHashSet(initialCapacities);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 33 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 34 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 35 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 36 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withMaximumSizes(Set&lt;Integer&gt; maximumSizes) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 37 </span></span><span><span style="background-color: transparent">    this.maximumSizes = Sets.newLinkedHashSet(maximumSizes);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 38 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 39 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 40 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 41 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">withExpirations</span></span><span><span style="background-color: transparent">(</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">Set&lt;ExpirationSpec&gt; expirations</span></span><span><span style="background-color: transparent">) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 42 </span></span><span><span style="background-color: transparent">    this.</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expirations</span></span><span><span style="background-color: transparent"> = Sets.newLinkedHashSet(</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expirations</span></span><span><span style="background-color: transparent">);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 43 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 44 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 45 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 46 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withKeyStrengths(Set&lt;Strength&gt; keyStrengths) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 47 </span></span><span><span style="background-color: transparent">    this.keyStrengths = Sets.newLinkedHashSet(keyStrengths);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 48 </span></span><span><span style="background-color: transparent">    Preconditions.checkArgument(!this.keyStrengths.contains(Strength.SOFT));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 49 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 50 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 51 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 52 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withValueStrengths(Set&lt;Strength&gt; valueStrengths) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 53 </span></span><span><span style="background-color: transparent">    this.valueStrengths = Sets.newLinkedHashSet(valueStrengths);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 54 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 55 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 56 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 57 </span></span><span><span style="background-color: transparent">  Iterable&lt;CacheBuilder&lt;Object, Object&gt;&gt; buildAllPermutations() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 58 </span></span><span><span style="background-color: transparent">    @SuppressWarnings("unchecked")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 59 </span></span><span><span style="background-color: transparent">    Iterable&lt;List&lt;Object&gt;&gt; combinations = buildCartesianProduct(concurrencyLevels,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 60 </span></span><span><span style="background-color: transparent">        initialCapacities, maximumSizes, </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expirations</span></span><span><span style="background-color: transparent">, </span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 60 </span></span><span><span style="background-color: transparent">keyStrengths, valueStrengths);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 61 </span></span><span><span style="background-color: transparent">    return Iterables.transform(combinations,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 62 </span></span><span><span style="background-color: transparent">        new Function&lt;List&lt;Object&gt;, CacheBuilder&lt;Object, Object&gt;&gt;() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 63 </span></span><span><span style="background-color: transparent">          @Override public CacheBuilder&lt;Object, Object&gt; apply(List&lt;Object&gt; combination) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 64 </span></span><span><span style="background-color: transparent">            return createCacheBuilder(</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 65 </span></span><span><span style="background-color: transparent">                (Integer) combination.get(0),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 66 </span></span><span><span style="background-color: transparent">                (Integer) combination.get(1),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 67 </span></span><span><span style="background-color: transparent">                (Integer) combination.get(2),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 68 </span></span><span><span style="background-color: transparent">                (</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">ExpirationSpec</span></span><span><span style="background-color: transparent">) combination.get(3),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 69 </span></span><span><span style="background-color: transparent">                (</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">Strength</span></span><span><span style="background-color: transparent">) combination.get(4),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 70 </span></span><span><span style="background-color: transparent">                (</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">Strength</span></span><span><span style="background-color: transparent">) combination.get(5)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 70 </span></span><span><span style="background-color: transparent">);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 71 </span></span><span><span style="background-color: transparent">          }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 72 </span></span><span><span style="background-color: transparent">        });</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 73 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 74 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 75 </span></span><span><span style="background-color: transparent">  private static final Function&lt;Object, Optional&lt;?&gt;&gt; NULLABLE_TO_OPTIONAL =</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 76 </span></span><span><span style="background-color: transparent">      new Function&lt;Object, Optional&lt;?&gt;&gt;() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 77 </span></span><span><span style="background-color: transparent">        @Override public Optional&lt;?&gt; apply(@Nullable Object obj) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 78 </span></span><span><span style="background-color: transparent">          return Optional.fromNullable(obj);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 79 </span></span><span><span style="background-color: transparent">        }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 80 </span></span><span><span style="background-color: transparent">      };</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 81 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 82 </span></span><span><span style="background-color: transparent">  private static final Function&lt;Optional&lt;?&gt;, Object&gt; OPTIONAL_TO_NULLABLE =</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 83 </span></span><span><span style="background-color: transparent">      new Function&lt;Optional&lt;?&gt;, Object&gt;() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 84 </span></span><span><span style="background-color: transparent">        @Override public Object apply(Optional&lt;?&gt; optional) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 85 </span></span><span><span style="background-color: transparent">          return optional.orNull();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 86 </span></span><span><span style="background-color: transparent">        }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 87 </span></span><span><span style="background-color: transparent">      };</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 88 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 89 </span></span><span><span style="background-color: transparent">  private Iterable&lt;List&lt;Object&gt;&gt; buildCartesianProduct(Set&lt;?&gt;... sets) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 90 </span></span><span><span style="background-color: transparent">    List&lt;Set&lt;Optional&lt;?&gt;&gt;&gt; optionalSets = Lists.newArrayListWithExpectedSize(sets.length);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 91 </span></span><span><span style="background-color: transparent">    for (Set&lt;?&gt; set : sets) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 92 </span></span><span><span style="background-color: transparent">      Set&lt;Optional&lt;?&gt;&gt; optionalSet =</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 93 </span></span><span><span style="background-color: transparent">          Sets.newLinkedHashSet(Iterables.transform(set, NULLABLE_TO_OPTIONAL));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 94 </span></span><span><span style="background-color: transparent">      optionalSets.add(optionalSet);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 95 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 96 </span></span><span><span style="background-color: transparent">    Set&lt;List&lt;Optional&lt;?&gt;&gt;&gt; cartesianProduct = Sets.cartesianProduct(optionalSets);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 97 </span></span><span><span style="background-color: transparent">    return Iterables.transform(cartesianProduct,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 98 </span></span><span><span style="background-color: transparent">        new Function&lt;List&lt;Optional&lt;?&gt;&gt;, List&lt;Object&gt;&gt;() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 99 </span></span><span><span style="background-color: transparent">          @Override public List&lt;Object&gt; apply(List&lt;Optional&lt;?&gt;&gt; objs) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">100 </span></span><span><span style="background-color: transparent">            return Lists.transform(objs, OPTIONAL_TO_NULLABLE);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">101 </span></span><span><span style="background-color: transparent">          }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">102 </span></span><span><span style="background-color: transparent">        });</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">103 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">104 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">105 </span></span><span><span style="background-color: transparent">  private CacheBuilder&lt;Object, Object&gt; createCacheBuilder(</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">106 </span></span><span><span style="background-color: transparent">      Integer concurrencyLevel, Integer initialCapacity, Integer maximumSize,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">107 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">ExpirationSpec expiration</span></span><span><span style="background-color: transparent">, </span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">107 </span></span><span><span style="background-color: transparent">Strength keyStrength, Strength valueStrength) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">108 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">109 </span></span><span><span style="background-color: transparent">    CacheBuilder&lt;Object, Object&gt; builder = CacheBuilder.newBuilder();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">110 </span></span><span><span style="background-color: transparent">    if (concurrencyLevel != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">111 </span></span><span><span style="background-color: transparent">      builder.concurrencyLevel(concurrencyLevel);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">112 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">113 </span></span><span><span style="background-color: transparent">    if (initialCapacity != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">114 </span></span><span><span style="background-color: transparent">      builder.initialCapacity(initialCapacity);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">115 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">116 </span></span><span><span style="background-color: transparent">    if (maximumSize != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">117 </span></span><span><span style="background-color: transparent">      builder.maximumSize(maximumSize);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">118 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">119 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">if (expiration != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">120 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">if (expiration.expireAfterAccessMillis != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">121 </span></span><span><span style="background-color: transparent">        </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">builder.expireAfterAccess(expiration.expireAfterAccessMillis, TimeUnit.MILLISECONDS);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">122 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">123 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">if (expiration.expireAfterWriteMillis != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">124 </span></span><span><span style="background-color: transparent">        </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">builder.expireAfterWrite(expiration.expireAfterWriteMillis, TimeUnit.MILLISECONDS);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">125 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">126 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">126 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">127 </span></span><span><span style="background-color: transparent">    if (keyStrength != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">128 </span></span><span><span style="background-color: transparent">      builder.setKeyStrength(keyStrength);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">129 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">130 </span></span><span><span style="background-color: transparent">    if (valueStrength != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">131 </span></span><span><span style="background-color: transparent">      builder.setValueStrength(valueStrength);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">132 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">133 </span></span><span><span style="background-color: transparent">    return builder;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">134 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">135 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">136 </span></span><span><span style="background-color: transparent">  static class </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">ExpirationSpec</span></span><span><span style="background-color: transparent"> {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">137 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">@Nullable</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">138 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">private final Long expireAfterAccessMillis;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">139 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">@Nullable</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">140 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">private final Long expireAfterWriteMillis;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">141 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">142 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">private ExpirationSpec(Long expireAfterAccessMillis, Long expireAfterWriteMillis) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">143 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">Preconditions.checkArgument(</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">144 </span></span><span><span style="background-color: transparent">          </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expireAfterAccessMillis == null || expireAfterWriteMillis == null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">145 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">this.expireAfterAccessMillis = expireAfterAccessMillis;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">146 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">this.expireAfterWriteMillis = expireAfterWriteMillis;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">147 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">148 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">149 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">public static ExpirationSpec afterAccess(long afterAccess, TimeUnit unit) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">150 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">return new ExpirationSpec(unit.toMillis(afterAccess), null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">151 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">152 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">153 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">public static ExpirationSpec afterWrite(long afterWrite, TimeUnit unit) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">154 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">return new ExpirationSpec(null, unit.toMillis(afterWrite));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">155 </span></span><span><span style="background-color: transparent">    </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">155 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">156 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">157 </span></span><span><span style="background-color: transparent">    @Override</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">158 </span></span><span><span style="background-color: transparent">    public int hashCode() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">159 </span></span><span><span style="background-color: transparent">      return </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">Objects.hashCode(expireAfterAccessMillis, expireAfterWriteMillis);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">160 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">161 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">162 </span></span><span><span style="background-color: transparent">    @Override</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">163 </span></span><span><span style="background-color: transparent">    public boolean equals(Object o) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">164 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">if (o instanceof ExpirationSpec) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">165 </span></span><span><span style="background-color: transparent">        </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">ExpirationSpec that = (ExpirationSpec) o;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">166 </span></span><span><span style="background-color: transparent">        </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">return Objects.equal(this.expireAfterAccessMillis, that.expireAfterAccessMillis)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">167 </span></span><span><span style="background-color: transparent">            </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">&amp;&amp; Objects.equal(this.expireAfterWriteMillis, that.expireAfterWriteMillis);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">168 </span></span><span><span style="background-color: transparent">      </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">168 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">169 </span></span><span><span style="background-color: transparent">      return false;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">170 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">171 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">172 </span></span><span><span style="background-color: transparent">    @Override</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">173 </span></span><span><span style="background-color: transparent">    public String toString() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">174 </span></span><span><span style="background-color: transparent">      return Objects.toStringHelper(this)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">175 </span></span><span><span style="background-color: transparent">          .add("</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expireAfterAccessMillis</span></span><span><span style="background-color: transparent">", </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expireAfterAccessMillis</span></span><span><span style="background-color: transparent">)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">176 </span></span><span><span style="background-color: transparent">          .add("</span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expireAfterWriteMillis</span></span><span><span style="background-color: transparent">", </span></span><span style="color:grey; text-decoration: line-through;"><span style="color: black; background-color: rgb(255,187,187); font-weight: bold;">expireAfterWriteMillis</span></span><span><span style="background-color: transparent">)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">177 </span></span><span><span style="background-color: transparent">          .toString();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">178 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">179 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">180 </span></span><span><span style="background-color: transparent">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">181 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span></pre></td></tr></table></td><td style="border: 1px solid black; border-collapse: collapse;"><table><tr><th><strong>Modified</strong></th></tr><tr><td><pre><span><span style="color: grey">  1 </span></span><span><span style="background-color: transparent">package com.google.common.cache;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  2 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  3 </span></span><span><span style="background-color: transparent">import com.google.common.base.Function;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  4 </span></span><span><span style="background-color: transparent">import com.google.common.base.Objects;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  5 </span></span><span><span style="background-color: transparent">import com.google.common.base.Optional;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  6 </span></span><span><span style="background-color: transparent">import com.google.common.base.Preconditions;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  7 </span></span><span><span style="background-color: transparent">import com.google.common.cache.LocalCache.Strength;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  8 </span></span><span><span style="background-color: transparent">import com.google.common.collect.Iterables;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">  9 </span></span><span><span style="background-color: transparent">import com.google.common.collect.Lists;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 10 </span></span><span><span style="background-color: transparent">import com.google.common.collect.Sets;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 11 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 12 </span></span><span><span style="background-color: transparent">import java.util.List;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 13 </span></span><span><span style="background-color: transparent">import java.util.Set;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 14 </span></span><span><span style="background-color: transparent">import java.util.concurrent.TimeUnit;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 15 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 16 </span></span><span><span style="background-color: transparent">import javax.annotation.Nullable;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 17 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 18 </span></span><span><span style="background-color: transparent">class CacheBuilderFactory {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 19 </span></span><span><span style="background-color: transparent">  private Set&lt;Integer&gt; concurrencyLevels = Sets.newHashSet((Integer) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 20 </span></span><span><span style="background-color: transparent">  private Set&lt;Integer&gt; initialCapacities = Sets.newHashSet((Integer) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 21 </span></span><span><span style="background-color: transparent">  private Set&lt;Integer&gt; maximumSizes = Sets.newHashSet((Integer) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 22 </span></span><span><span style="background-color: transparent">  private Set&lt;</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec</span></span><span><span style="background-color: transparent">&gt; </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">expireAfterWrites</span></span><span><span style="background-color: transparent"> = Sets.newHashSet((</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec</span></span><span><span style="background-color: transparent">) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 23 </span></span><span><span style="background-color: transparent">  </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">private Set&lt;DurationSpec&gt; expireAfterAccesses = Sets.newHashSet((DurationSpec) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 24 </span></span><span><span style="background-color: transparent">  </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">private Set&lt;DurationSpec&gt; refreshes = Sets.newHashSet((DurationSpec) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 25 </span></span><span><span style="background-color: transparent">  private Set&lt;Strength&gt; keyStrengths = Sets.newHashSet((Strength) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 26 </span></span><span><span style="background-color: transparent">  private Set&lt;Strength&gt; valueStrengths = Sets.newHashSet((Strength) null);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 27 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 28 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withConcurrencyLevels(Set&lt;Integer&gt; concurrencyLevels) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 29 </span></span><span><span style="background-color: transparent">    this.concurrencyLevels = Sets.newLinkedHashSet(concurrencyLevels);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 30 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 31 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 32 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 33 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withInitialCapacities(Set&lt;Integer&gt; initialCapacities) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 34 </span></span><span><span style="background-color: transparent">    this.initialCapacities = Sets.newLinkedHashSet(initialCapacities);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 35 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 36 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 37 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 38 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withMaximumSizes(Set&lt;Integer&gt; maximumSizes) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 39 </span></span><span><span style="background-color: transparent">    this.maximumSizes = Sets.newLinkedHashSet(maximumSizes);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 40 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 41 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 42 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 43 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">withExpireAfterWrites</span></span><span><span style="background-color: transparent">(</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">Set&lt;DurationSpec&gt; durations</span></span><span><span style="background-color: transparent">) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 44 </span></span><span><span style="background-color: transparent">    this.</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">expireAfterWrites</span></span><span><span style="background-color: transparent"> = Sets.newLinkedHashSet(</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">durations</span></span><span><span style="background-color: transparent">);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 45 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 46 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 47 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 48 </span></span><span><span style="background-color: transparent">  </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">CacheBuilderFactory withExpireAfterAccesses(Set&lt;DurationSpec&gt; durations) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 49 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">this.expireAfterAccesses = Sets.newLinkedHashSet(durations);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 50 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 51 </span></span><span><span style="background-color: transparent">  </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 52 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 53 </span></span><span><span style="background-color: transparent">  </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">CacheBuilderFactory withRefreshes(Set&lt;DurationSpec&gt; durations) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 54 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">this.refreshes = Sets.newLinkedHashSet(durations);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 55 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 56 </span></span><span><span style="background-color: transparent">  </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 57 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 58 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withKeyStrengths(Set&lt;Strength&gt; keyStrengths) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 59 </span></span><span><span style="background-color: transparent">    this.keyStrengths = Sets.newLinkedHashSet(keyStrengths);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 60 </span></span><span><span style="background-color: transparent">    Preconditions.checkArgument(!this.keyStrengths.contains(Strength.SOFT));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 61 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 62 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 63 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 64 </span></span><span><span style="background-color: transparent">  CacheBuilderFactory withValueStrengths(Set&lt;Strength&gt; valueStrengths) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 65 </span></span><span><span style="background-color: transparent">    this.valueStrengths = Sets.newLinkedHashSet(valueStrengths);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 66 </span></span><span><span style="background-color: transparent">    return this;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 67 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 68 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 69 </span></span><span><span style="background-color: transparent">  Iterable&lt;CacheBuilder&lt;Object, Object&gt;&gt; buildAllPermutations() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 70 </span></span><span><span style="background-color: transparent">    @SuppressWarnings("unchecked")</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 71 </span></span><span><span style="background-color: transparent">    Iterable&lt;List&lt;Object&gt;&gt; combinations = buildCartesianProduct(concurrencyLevels,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 72 </span></span><span><span style="background-color: transparent">        initialCapacities, maximumSizes, </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">expireAfterWrites</span></span><span><span style="background-color: transparent">, </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">expireAfterAccesses, refreshes,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 73 </span></span><span><span style="background-color: transparent">        keyStrengths, valueStrengths);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 74 </span></span><span><span style="background-color: transparent">    return Iterables.transform(combinations,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 75 </span></span><span><span style="background-color: transparent">        new Function&lt;List&lt;Object&gt;, CacheBuilder&lt;Object, Object&gt;&gt;() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 76 </span></span><span><span style="background-color: transparent">          @Override public CacheBuilder&lt;Object, Object&gt; apply(List&lt;Object&gt; combination) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 77 </span></span><span><span style="background-color: transparent">            return createCacheBuilder(</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 78 </span></span><span><span style="background-color: transparent">                (Integer) combination.get(0),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 79 </span></span><span><span style="background-color: transparent">                (Integer) combination.get(1),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 80 </span></span><span><span style="background-color: transparent">                (Integer) combination.get(2),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 81 </span></span><span><span style="background-color: transparent">                (</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec</span></span><span><span style="background-color: transparent">) combination.get(3),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 82 </span></span><span><span style="background-color: transparent">                (</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec</span></span><span><span style="background-color: transparent">) combination.get(4),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 83 </span></span><span><span style="background-color: transparent">                (</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec</span></span><span><span style="background-color: transparent">) combination.get(5)</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 84 </span></span><span><span style="background-color: transparent">                </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">(Strength) combination.get(6),</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 85 </span></span><span><span style="background-color: transparent">                </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">(Strength) combination.get(7)</span></span><span><span style="background-color: transparent">);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 86 </span></span><span><span style="background-color: transparent">          }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 87 </span></span><span><span style="background-color: transparent">        });</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 88 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 89 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 90 </span></span><span><span style="background-color: transparent">  private static final Function&lt;Object, Optional&lt;?&gt;&gt; NULLABLE_TO_OPTIONAL =</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 91 </span></span><span><span style="background-color: transparent">      new Function&lt;Object, Optional&lt;?&gt;&gt;() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 92 </span></span><span><span style="background-color: transparent">        @Override public Optional&lt;?&gt; apply(@Nullable Object obj) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 93 </span></span><span><span style="background-color: transparent">          return Optional.fromNullable(obj);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 94 </span></span><span><span style="background-color: transparent">        }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 95 </span></span><span><span style="background-color: transparent">      };</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 96 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 97 </span></span><span><span style="background-color: transparent">  private static final Function&lt;Optional&lt;?&gt;, Object&gt; OPTIONAL_TO_NULLABLE =</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 98 </span></span><span><span style="background-color: transparent">      new Function&lt;Optional&lt;?&gt;, Object&gt;() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"> 99 </span></span><span><span style="background-color: transparent">        @Override public Object apply(Optional&lt;?&gt; optional) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">100 </span></span><span><span style="background-color: transparent">          return optional.orNull();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">101 </span></span><span><span style="background-color: transparent">        }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">102 </span></span><span><span style="background-color: transparent">      };</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">103 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">104 </span></span><span><span style="background-color: transparent">  private Iterable&lt;List&lt;Object&gt;&gt; buildCartesianProduct(Set&lt;?&gt;... sets) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">105 </span></span><span><span style="background-color: transparent">    List&lt;Set&lt;Optional&lt;?&gt;&gt;&gt; optionalSets = Lists.newArrayListWithExpectedSize(sets.length);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">106 </span></span><span><span style="background-color: transparent">    for (Set&lt;?&gt; set : sets) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">107 </span></span><span><span style="background-color: transparent">      Set&lt;Optional&lt;?&gt;&gt; optionalSet =</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">108 </span></span><span><span style="background-color: transparent">          Sets.newLinkedHashSet(Iterables.transform(set, NULLABLE_TO_OPTIONAL));</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">109 </span></span><span><span style="background-color: transparent">      optionalSets.add(optionalSet);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">110 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">111 </span></span><span><span style="background-color: transparent">    Set&lt;List&lt;Optional&lt;?&gt;&gt;&gt; cartesianProduct = Sets.cartesianProduct(optionalSets);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">112 </span></span><span><span style="background-color: transparent">    return Iterables.transform(cartesianProduct,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">113 </span></span><span><span style="background-color: transparent">        new Function&lt;List&lt;Optional&lt;?&gt;&gt;, List&lt;Object&gt;&gt;() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">114 </span></span><span><span style="background-color: transparent">          @Override public List&lt;Object&gt; apply(List&lt;Optional&lt;?&gt;&gt; objs) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">115 </span></span><span><span style="background-color: transparent">            return Lists.transform(objs, OPTIONAL_TO_NULLABLE);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">116 </span></span><span><span style="background-color: transparent">          }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">117 </span></span><span><span style="background-color: transparent">        });</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">118 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">119 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">120 </span></span><span><span style="background-color: transparent">  private CacheBuilder&lt;Object, Object&gt; createCacheBuilder(</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">121 </span></span><span><span style="background-color: transparent">      Integer concurrencyLevel, Integer initialCapacity, Integer maximumSize,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">122 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec expireAfterWrite</span></span><span><span style="background-color: transparent">, </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec expireAfterAccess, DurationSpec refresh,</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">123 </span></span><span><span style="background-color: transparent">      Strength keyStrength, Strength valueStrength) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">124 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">125 </span></span><span><span style="background-color: transparent">    CacheBuilder&lt;Object, Object&gt; builder = CacheBuilder.newBuilder();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">126 </span></span><span><span style="background-color: transparent">    if (concurrencyLevel != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">127 </span></span><span><span style="background-color: transparent">      builder.concurrencyLevel(concurrencyLevel);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">128 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">129 </span></span><span><span style="background-color: transparent">    if (initialCapacity != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">130 </span></span><span><span style="background-color: transparent">      builder.initialCapacity(initialCapacity);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">131 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">132 </span></span><span><span style="background-color: transparent">    if (maximumSize != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">133 </span></span><span><span style="background-color: transparent">      builder.maximumSize(maximumSize);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">134 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">135 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">if (expireAfterWrite != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">136 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">builder.expireAfterWrite(expireAfterWrite.duration, expireAfterWrite.unit);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">137 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">138 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">if (expireAfterAccess != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">139 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">builder.expireAfterAccess(expireAfterAccess.duration, expireAfterAccess.unit);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">140 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">141 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">if (refresh != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">142 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">builder.refreshInterval(refresh.duration, refresh.unit);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">143 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">144 </span></span><span><span style="background-color: transparent">    if (keyStrength != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">145 </span></span><span><span style="background-color: transparent">      builder.setKeyStrength(keyStrength);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">146 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">147 </span></span><span><span style="background-color: transparent">    if (valueStrength != null) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">148 </span></span><span><span style="background-color: transparent">      builder.setValueStrength(valueStrength);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">149 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">150 </span></span><span><span style="background-color: transparent">    return builder;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">151 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">152 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">153 </span></span><span><span style="background-color: transparent">  static class </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec</span></span><span><span style="background-color: transparent"> {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">154 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">private final long duration;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">155 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">private final TimeUnit unit;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">156 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">157 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">private DurationSpec(long duration, TimeUnit unit) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">158 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">this.duration = duration;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">159 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">this.unit = unit;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">160 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">161 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">162 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">public static DurationSpec of(long duration, TimeUnit unit) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">163 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">return new DurationSpec(duration, unit);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">164 </span></span><span><span style="background-color: transparent">    </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">165 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">166 </span></span><span><span style="background-color: transparent">    @Override</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">167 </span></span><span><span style="background-color: transparent">    public int hashCode() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">168 </span></span><span><span style="background-color: transparent">      return </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">Objects.hashCode(duration, unit);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">169 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">170 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">171 </span></span><span><span style="background-color: transparent">    @Override</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">172 </span></span><span><span style="background-color: transparent">    public boolean equals(Object o) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey"></span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">173 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">if (o instanceof DurationSpec) {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">174 </span></span><span><span style="background-color: transparent">        </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">DurationSpec that = (DurationSpec) o;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">175 </span></span><span><span style="background-color: transparent">        </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">return unit.toNanos(duration) == that.unit.toNanos(that.duration);</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">176 </span></span><span><span style="background-color: transparent">      </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">177 </span></span><span><span style="background-color: transparent">      return false;</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">178 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">179 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">180 </span></span><span><span style="background-color: transparent">    @Override</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">181 </span></span><span><span style="background-color: transparent">    public String toString() {</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">182 </span></span><span><span style="background-color: transparent">      return Objects.toStringHelper(this)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">183 </span></span><span><span style="background-color: transparent">          .add("</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">duration</span></span><span><span style="background-color: transparent">", </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">duration</span></span><span><span style="background-color: transparent">)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">184 </span></span><span><span style="background-color: transparent">          .add("</span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">unit</span></span><span><span style="background-color: transparent">", </span></span><span><span style="background-color: rgb(0,250,108)  ; font-weight: bold;">unit</span></span><span><span style="background-color: transparent">)</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">185 </span></span><span><span style="background-color: transparent">          .toString();</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">186 </span></span><span><span style="background-color: transparent">    }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">187 </span></span><span><span style="background-color: transparent">  }</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">188 </span></span><span><span style="background-color: transparent">}</span></span><span><span style="background-color: transparent">
</span></span><span><span style="color: grey">189 </span></span><span><span style="background-color: transparent"></span></span><span><span style="background-color: transparent">
</span></span></pre></td></tr></table></td></tr></table></div></body></html>